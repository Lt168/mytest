
# 导入streamlit库（用于快速搭建可视化Web应用）和pandas库（用于数据处理与分析）
import streamlit as st
import pandas as pd

# 设置仪表盘的主标题，显示在页面最顶部
st.title("🍜 南宁美食数据仪表盘")

# 配置页面基础属性：标题（浏览器标签页显示）、图标、宽屏布局（适配大屏展示）
st.set_page_config(page_title="南宁美食数据仪表盘", page_icon="🍜", layout="wide")

# 定义字典：存储5家店铺12个月的核心数据（此处为销量/价格类数据）
data = {
   '月份': ['01月','02月','03月','04月','05月','06月','07月','08月','09月','10月','11月','12月'],  # 12个月份标签
   "蛙小侠(万象城店)": [521,421,321,214,321,416,154,80,79,79,78,78],  # 蛙小侠1-12月对应数据
    "海底捞(航洋城店)": [201,521,352,568,423,632,461,210,700,605,710,653],  # 海底捞1-12月对应数据
    "塔斯汀(朝阳广场店)": [135,651,542,328,653,452,721,360,480,395,470,533],  # 塔斯汀1-12月对应数据
    "螺小丰螺蛳粉(建政路店)": [754,678,654,645,345,345,456,735,562,436,486,579],  # 螺小丰1-12月对应数据
    "甘家界柠檬鸭(园湖路店)": [354,345,767,645,758,782,764,459,900,732,384,679]  # 甘家界1-12月对应数据
    }

# 设置子标题：标注下方表格为店铺数据表，增强页面可读性
st.markdown("### 🍜店铺数据表")

# 创建序号序列：1-12作为表格的行索引，name参数设置索引名称为"序号"
ind= pd.Series([1,2,3,4,5,6,7,8,9,10,11,12],name='序号')

# 将字典转换为DataFrame（表格型数据结构），并设置"序号"为行索引
df = pd.DataFrame(data,index=ind)

# 在页面展示交互式表格，默认展示df的所有数据
st.dataframe(df)

# 重新创建月份序列：用于价格走势图表的行索引，name参数设置索引名称为"月份"
ind = pd.Series(
    ['01月','02月','03月','04月','05月','06月','07月','08月','09月','10月','11月','12月'],
    name="月份"
)

# 定义字典：存储5家店铺12个月的价格走势数据（与上方data数据一致，可根据需求替换为实际价格）
price_trend = {
    "月份": ind,  # 关联12个月的索引序列
    "蛙小侠(万象城店)": [521,421,321,214,321,416,154,80,79,79,78,78],  # 蛙小侠1-12月价格/销量数据
    "海底捞(航洋城店)": [201,521,352,568,423,632,461,210,700,605,710,653],  # 海底捞1-12月价格/销量数据
    "塔斯汀(朝阳广场店)": [135,651,542,328,653,452,721,360,480,395,470,533],  # 塔斯汀1-12月价格/销量数据
    "螺小丰螺蛳粉(建政路店)": [754,678,654,645,345,345,456,735,562,436,486,579],  # 螺小丰1-12月价格/销量数据
    "甘家界柠檬鸭(园湖路店)": [354,345,767,645,758,782,764,459,900,732,384,679]  # 甘家界1-12月价格/销量数据
}

# 将价格走势字典转换为DataFrame，设置"月份"为行索引，便于按月份展示趋势
df_price = pd.DataFrame(price_trend).set_index("月份")

# 定义字典：存储5家店铺各时段（10-22时）的用餐高峰客流数据
peak_data = {
    "时段(时)": [10,11,12,13,14,17,18,19,20,21,22],  # 用餐时段（小时），覆盖午/晚餐高峰
    "蛙小侠(万象城店)": [120,200,350,280,150,220,400,450,380,250,180],  # 蛙小侠各时段客流
    "海底捞(航洋城店)": [150,220,380,300,180,250,420,480,400,280,200],  # 海底捞各时段客流
    "塔斯汀(朝阳广场店)": [200,300,450,350,200,300,500,550,480,350,250],  # 塔斯汀各时段客流
    "螺小丰螺蛳粉(建政路店)": [754,678,654,645,345,345,456,735,562,436,486],  # 螺小丰各时段客流
    "甘家界柠檬鸭(园湖路店)": [354,345,767,645,758,782,764,459,900,732,384]  # 甘家界各时段客流
}

# 设置子标题：标注下方图表为用餐高峰时段分析
st.markdown("### 🍽️ 用餐高峰时段")

# 将客流数据字典转换为DataFrame，设置"时段(时)"为行索引，便于按时段展示客流变化
df_peak = pd.DataFrame(peak_data).set_index("时段(时)")

# 绘制用餐高峰时段面积图：use_container_width=True表示图表宽度适配页面
st.area_chart(df_peak, use_container_width=True)

# 定义字典：存储5家店铺的基础信息（含定位、评分、品类等）
shop_info = {
    "店铺名称": [  # 店铺名称列表
        "蛙小侠(万象城店)", "海底捞(航洋城店)", "塔斯汀(朝阳广场店)",
        "螺小丰螺蛳粉(建政路店)", "甘家界柠檬鸭(园湖路店)"
    ],
    "美食类型": ["牛蛙火锅", "川味火锅", "中式汉堡", "螺蛳粉", "柠檬鸭"],  # 对应店铺的美食品类
    "评分": [9.0, 10, 8.7, 12, 7],  # 店铺评分（自定义分值）
    "人均价格(元)": [78, 128, 25, 18, 68],  # 人均消费金额
    "latitude": [22.8068, 22.8195, 22.8170, 22.8347, 22.8400],  # 店铺纬度（用于地图定位）
    "longitude": [108.3562, 108.3420, 108.3220, 108.2683, 108.2454]  # 店铺经度（用于地图定位）
}

# 将店铺信息字典转换为DataFrame，设置"店铺名称"为行索引，便于按店铺筛选数据
df_shop = pd.DataFrame(shop_info).set_index("店铺名称")

# 设置子标题：标注下方为店铺分布地图
st.markdown("### 🗺️ 店铺分布地图")

# 绘制店铺分布地图：传入经纬度列，zoom=12适配南宁城区展示范围
st.map(df_shop[["latitude", "longitude"]], zoom=12)
  
# 提取"美食类型"和"人均价格(元)"列，重置行索引后设置"美食类型"为新索引，用于按品类展示价格
df_type_price = df_shop[["美食类型", "人均价格(元)"]].reset_index(drop=True).set_index("美食类型")

# 设置子标题：标注下方为餐厅评分条形图
st.markdown("### ⭐ 餐厅评分")

# 绘制餐厅评分条形图：指定蓝色系配色，宽度适配页面
st.bar_chart(df_shop["评分"], color="#1E90FF", use_container_width=True)

# 设置子标题：标注下方为不同类型餐厅人均价格条形图
st.markdown("### 🍲 不同类型餐厅人均价格")

# 绘制品类价格条形图：指定红色系配色，宽度适配页面
st.bar_chart(df_type_price["人均价格(元)"], color="#FF6B6B", use_container_width=True)

# 添加水平分隔线：区分不同模块，增强页面视觉层次感
st.divider()

# 设置子标题：标注下方为12个月价格走势折线图
st.markdown("### 💰 12个月价格走势")

# 绘制价格走势折线图：宽度适配页面，展示5家店铺12个月数据变化
st.line_chart(df_price, use_container_width=True)
